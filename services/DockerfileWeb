FROM php:8.2-apache

RUN apt update && apt upgrade -y && apt install -y nano tzdata git curl

ENV TZ=America/Sao_Paulo
RUN ln -sf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone

ARG PHP_ENV=production
ENV PHP_ENV=${PHP_ENV}

RUN if [ "$PHP_ENV" = "production" ]; then \
        cp /usr/local/etc/php/php.ini-production /usr/local/etc/php/php.ini; \
    else \
        cp /usr/local/etc/php/php.ini-development /usr/local/etc/php/php.ini; \
    fi

RUN sed -i 's|;date.timezone =|date.timezone = America/Sao_Paulo|' /usr/local/etc/php/php.ini

CMD ["apachectl", "-D", "FOREGROUND"]